<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Explore Startups | StartupTeam</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    /* CORE & ANIMATIONS */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Poppins', sans-serif; background: #f1f5f9; color: #1e293b; overflow-x: hidden; }
    
    @keyframes slideInUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes fadeInRight {
      from { transform: translateX(-20px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .app { display: flex; min-height: 100vh; }

    /* SIDEBAR */
    .sidebar { width: 260px; min-width: 260px; background: #0f172a; color: #fff; padding: 30px 20px; display: flex; flex-direction: column; position: sticky; top: 0; height: 100vh; z-index: 1000; transition: width 0.3s ease; }
    .sidebar.collapsed { width: 80px; min-width: 80px; padding: 20px 10px; }
    .toggle-sidebar { background: none; border: none; color: #fff; cursor: pointer; font-size: 20px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 8px; transition: 0.3s; }
    .toggle-sidebar:hover { background: rgba(255,255,255,0.1); }
    .logo { font-size: 24px; font-weight: 700; margin-bottom: 40px; padding-left: 10px; transition: 0.3s; }
    .sidebar.collapsed .logo { font-size: 0; margin-bottom: 20px; padding-left: 0; }
    .logo span { color: #6366f1; }
    .sidebar nav { flex: 1; }
    .sidebar a { display: flex; align-items: center; gap: 12px; color: #94a3b8; text-decoration: none; padding: 12px 15px; border-radius: 10px; margin-bottom: 8px; transition: 0.3s; font-size: 14px; font-weight: 500; white-space: nowrap; }
    .sidebar.collapsed a { padding: 12px; justify-content: center; gap: 0; }
    .sidebar.collapsed a span { display: none; }
    .sidebar a.active { background: #6366f1; color: white !important; box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }
    .logout-btn { background: #ef4444; color: white; border: none; padding: 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-weight: 600; margin-top: auto; white-space: nowrap; transition: 0.3s; }
    .sidebar.collapsed .logout-btn { gap: 0; }
    .sidebar.collapsed .logout-btn span { display: none; }

    /* MAIN CONTENT */
    .main { flex: 1; padding: 40px; max-width: 1240px; margin: 0 auto; animation: fadeInRight 0.6s ease-out; }
    
    /* SEARCH & FILTER BAR */
    .controls-wrapper { display: flex; gap: 15px; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); padding: 15px; border-radius: 20px; border: 1px solid #fff; align-items: center; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.03); }
    .search-box { flex: 1; position: relative; }
    .search-box i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #94a3b8; }
    .search-box input { width: 100%; padding: 12px 45px; border-radius: 14px; border: 1px solid #e2e8f0; outline: none; font-size: 14px; transition: 0.3s; }
    .search-box input:focus { border-color: #6366f1; box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1); }

    .saved-toggle { display: flex; align-items: center; gap: 8px; padding: 10px 18px; background: #fff; border-radius: 14px; cursor: pointer; transition: 0.3s; font-size: 13px; font-weight: 600; color: #475569; border: 1px solid #e2e8f0; }
    .saved-toggle.active { background: #6366f1; color: #fff; border-color: #6366f1; }

    .categories { display: flex; gap: 10px; margin-bottom: 35px; overflow-x: auto; padding-bottom: 5px; }
    .chip { padding: 8px 20px; background: #fff; border: 1px solid #e2e8f0; border-radius: 100px; font-size: 13px; font-weight: 500; color: #64748b; cursor: pointer; transition: 0.3s; white-space: nowrap; }
    .chip.active { background: #0f172a; color: #fff; border-color: #0f172a; }

    /* STARTUP GRID */
    .startup-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; margin-bottom: 50px; }
    .card { background: #fff; padding: 25px; border-radius: 24px; border: 1px solid #f1f5f9; transition: 0.3s ease; position: relative; animation: slideInUp 0.5s ease-out backwards; }
    .card:hover { transform: translateY(-10px); box-shadow: 0 20px 30px rgba(0,0,0,0.05); border-color: #6366f1; }
    
    .trending-tag { position: absolute; top: -10px; right: 20px; background: linear-gradient(45deg, #f59e0b, #ef4444); color: white; padding: 4px 12px; border-radius: 20px; font-size: 10px; font-weight: 700; box-shadow: 0 4px 10px rgba(245, 158, 11, 0.3); z-index: 10; }

    .mini-logo { width: 54px; height: 54px; background: #eef2ff; color: #6366f1; border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 800; }
    
    .save-btn { background: #f8fafc; border: none; cursor: pointer; color: #cbd5e1; transition: 0.3s; padding: 8px; border-radius: 12px; }
    .save-btn.saved { color: #f59e0b; background: #fffbeb; }

    .industry-tag { font-size: 11px; color: #6366f1; font-weight: 700; background: #eff6ff; padding: 4px 10px; border-radius: 6px; display: inline-block; margin-bottom: 12px; }
    .card h3 { font-size: 18px; margin-bottom: 8px; color: #0f172a; }
    .card p { font-size: 14px; color: #64748b; line-height: 1.5; height: 42px; overflow: hidden; margin-bottom: 20px; }

    .card-footer { display: flex; align-items: center; justify-content: space-between; padding-top: 15px; border-top: 1px solid #f1f5f9; }
    .btn-apply { padding: 10px 20px; background: #0f172a; color: #fff; text-decoration: none; border-radius: 12px; font-weight: 600; font-size: 12px; transition: 0.3s; }
    .btn-apply:hover { background: #6366f1; }

    /* TOAST NOTIFICATION */
    #toast { position: fixed; bottom: 30px; right: 30px; background: #0f172a; color: #fff; padding: 12px 24px; border-radius: 12px; display: flex; align-items: center; gap: 10px; transform: translateY(100px); opacity: 0; transition: 0.4s; z-index: 2000; box-shadow: 0 10px 25px rgba(0,0,0,0.2); }
    #toast.show { transform: translateY(0); opacity: 1; }

    /* RECOMMENDATION SECTION */
    .rec-section { background: #fff; padding: 30px; border-radius: 24px; margin-top: 40px; border: 1px solid #e2e8f0; }
    .rec-grid { display: flex; gap: 20px; overflow-x: auto; padding: 10px 0; scrollbar-width: none; }
  </style>
</head>
<body>

<div id="toast"><i data-lucide="check-circle" size="18" color="#22c55e"></i> <span id="toastMsg">Action Successful!</span></div>

<div class="app">
  <aside class="sidebar">
    <button class="toggle-sidebar" onclick="toggleSidebar()"><i data-lucide="chevrons-left"></i></button>
    <div class="logo">Startup<span>Team</span></div>
    <nav>
      <a href="member-dashboard.html"><i data-lucide="layout-dashboard"></i> <span>Dashboard</span></a>
      <a href="explore-startups.html" class="active"><i data-lucide="search"></i> <span>Explore Startups</span></a>
      <a href="join-requests.html"><i data-lucide="send"></i> <span>My Requests</span></a>
      <a href="my-profile.html"><i data-lucide="user"></i> <span>My Profile</span></a>
      <a href="members-list.html"><i data-lucide="users"></i> <span>Explore Members</span></a>
    </nav>
    <button onclick="window.logoutUser()" class="logout-btn"><i data-lucide="log-out"></i> <span>Log Out</span></button>
  </aside>

  <main class="main">
    <div class="header-section" style="margin-bottom: 30px;">
      <h2 style="font-size: 32px; font-weight: 800; letter-spacing: -0.5px;">Explore Opportunities</h2>
      <p style="color: #64748b;">Connecting talented members with visionary founders.</p>
    </div>

    <div class="controls-wrapper">
      <div class="search-box">
        <i data-lucide="search" size="18"></i>
        <input type="text" id="searchInput" placeholder="Search by name, role or industry..." onkeyup="loadStartups()">
      </div>
      <div id="savedToggle" class="saved-toggle" onclick="toggleSavedFilter()">
        <i data-lucide="bookmark" size="16"></i>
        <span>Saved Only</span>
      </div>
    </div>

    <div class="categories" id="catBar">
      <div class="chip active" onclick="setCategory('All', this)">All Industries</div>
      <div class="chip" onclick="setCategory('SaaS', this)">SaaS</div>
      <div class="chip" onclick="setCategory('AI/ML', this)">AI/ML</div>
      <div class="chip" onclick="setCategory('Fintech', this)">Fintech</div>
      <div class="chip" onclick="setCategory('EdTech', this)">EdTech</div>
    </div>

    <div class="startup-grid" id="startupGrid"></div>

    <div class="rec-section" id="recArea">
      <div style="display:flex; align-items:center; gap:10px; margin-bottom:20px;">
        <i data-lucide="zap" fill="#6366f1" color="#6366f1"></i>
        <h3 style="font-size:20px;">Top Picks for You</h3>
      </div>
      <div class="rec-grid" id="recGrid"></div>
    </div>
  </main>
</div>

<script>
  // Sidebar toggle functionality
  function toggleSidebar() {
    const sidebar = document.querySelector('.sidebar');
    const icon = document.querySelector('.toggle-sidebar i');
    sidebar.classList.toggle('collapsed');
    if (sidebar.classList.contains('collapsed')) {
      icon.setAttribute('data-lucide', 'chevrons-right');
      localStorage.setItem('sidebarCollapsed', 'true');
    } else {
      icon.setAttribute('data-lucide', 'chevrons-left');
      localStorage.setItem('sidebarCollapsed', 'false');
    }
    lucide.createIcons();
  }

  function restoreSidebarState() {
    const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    const sidebar = document.querySelector('.sidebar');
    const icon = document.querySelector('.toggle-sidebar i');
    if (isCollapsed) {
      sidebar.classList.add('collapsed');
      icon.setAttribute('data-lucide', 'chevrons-right');
    } else {
      sidebar.classList.remove('collapsed');
      icon.setAttribute('data-lucide', 'chevrons-left');
    }
  }

  // Call restore before page fully loads
  restoreSidebarState();

  let currentCategory = 'All';
  let showSavedOnly = false;

  function showToast(msg) {
    const toast = document.getElementById('toast');
    document.getElementById('toastMsg').innerText = msg;
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  function loadStartups() {
    const grid = document.getElementById('startupGrid');
    const startups = JSON.parse(localStorage.getItem("allStartups")) || [];
    const savedIds = JSON.parse(localStorage.getItem("savedStartups")) || [];

    const term = document.getElementById('searchInput').value.toLowerCase();
    
    const filtered = startups.filter(s => {
      const match = s.name.toLowerCase().includes(term) || (s.industry && s.industry.toLowerCase().includes(term));
      const catMatch = currentCategory === 'All' || s.industry === currentCategory;
      const saveMatch = !showSavedOnly || savedIds.includes(s.id);
      return match && catMatch && saveMatch;
    });

    if (filtered.length === 0) {
      grid.innerHTML = `<div style="grid-column: 1/-1; text-align:center; padding:50px; color:#94a3b8">No startups match your search.</div>`;
    } else {
      grid.innerHTML = filtered.map((s, idx) => `
        <div class="card" style="animation-delay: ${idx * 0.1}s">
          ${idx < 2 ? '<div class="trending-tag">ðŸ”¥ TRENDING</div>' : ''}
          <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:15px;">
            <div class="mini-logo">${s.name.charAt(0)}</div>
            <button class="save-btn ${savedIds.includes(s.id) ? 'saved' : ''}" onclick="toggleSave('${s.id}', event)">
              <i data-lucide="bookmark" size="18" ${savedIds.includes(s.id) ? 'fill="currentColor"' : ''}></i>
            </button>
          </div>
          <span class="industry-tag">${s.industry || 'Startup'}</span>
          <h3>${s.name}</h3>
          <p>${s.tagline || s.desc.substring(0, 60) + '...'}</p>
          <div class="card-footer">
             <div style="display:flex; align-items:center; gap:5px; font-size:12px; color:#64748b">
               <i data-lucide="users" size="14"></i> 5-10
             </div>
             <a href="posted-roles.html?id=${s.id}" class="btn-apply">View Profile</a>
          </div>
        </div>
      `).join('');
    }
    
    // Recommendations Logic
    const recGrid = document.getElementById('recGrid');
    const recs = startups.filter(s => !savedIds.includes(s.id)).slice(0, 4);
    recGrid.innerHTML = recs.map(s => `
      <div class="card" style="min-width:280px; padding:15px; cursor:pointer" onclick="window.location.href='posted-roles.html?id=${s.id}'">
        <h4 style="font-size:14px;">${s.name}</h4>
        <span style="font-size:11px; color:#6366f1">${s.industry}</span>
      </div>
    `).join('');

    lucide.createIcons();
  }

  function toggleSave(id, e) {
    e.stopPropagation();
    let saved = JSON.parse(localStorage.getItem("savedStartups")) || [];
    if (saved.includes(id)) {
      saved = saved.filter(i => i !== id);
      showToast("Removed from favorites");
    } else {
      saved.push(id);
      showToast("Added to favorites!");
    }
    localStorage.setItem("savedStartups", JSON.stringify(saved));
    loadStartups();
  }

  function toggleSavedFilter() {
    showSavedOnly = !showSavedOnly;
    document.getElementById('savedToggle').classList.toggle('active');
    loadStartups();
  }

  function setCategory(cat, el) {
    currentCategory = cat;
    document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
    el.classList.add('active');
    loadStartups();
  }

  window.onload = loadStartups;
  function logout() { localStorage.removeItem("loggedIn"); window.location.href = "../../index.html"; }
</script>
<script type="module" src="../assets/js/logout.js"></script>
</body>
</html>